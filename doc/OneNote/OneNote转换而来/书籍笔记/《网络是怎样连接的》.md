---
title: 《网络是怎样连接的》
updated: 2021-11-15T11:12:22
created: 2021-09-11T15:57:20
---

**第1章 浏览器生成消息 ——探索浏览器内部**
**1.1 生成HTTP请求消息**
⭐**URL：**Uniform Resource Locator，统一资源定位符。
HTTP：Hypertext Transfer Protocol，超文本传输协议
![](C:\Users\Administrator\AppData\Local\Temp\国同 的笔记本\pandoc/media/image1.png)

⭐**URI：**Uniform Resource Identifier，统一资源标识符。

⭐1 条请求消息中只能写 1 个 URI。如果需要获取多个文件，必须 对每个文件单独发送 1 条请求。

**1.2 向 DNS 服务器查询 Web 服务器的 IP 地址**

⭐数据是以包的形式传送的。

⭐ip地址=网络号+主机号 例：198.152.15.18
子网掩码是附加信息，用来区分开**网络号跟主机号**，例如**198.152.15.18/255.255.255.0**则代表网络号是198.152.15，而主机号是18。
子网掩码中1（255）标识网络号，0表示主机号。

⭐IP 地址的主机号
全 0：表示整个子网
全 1：表示向子网上所有设备发送包，即“广播”

⭐**DNS：**Domain Name System，域名服务系统。将服务器名称和 IP 地址进行 关联是 DNS最常见的用法，但 DNS 的功能并不仅限于此，它还可以将邮 件地址和邮件服务器进行关联，以及为各种信息关联相应的名称。

⭐**Socket 库是用于调用网络功能的程序组件集合。**
![](C:\Users\Administrator\AppData\Local\Temp\国同 的笔记本\pandoc/media/image2.png)

⭐**解析器的内部原理gethostbyname**
![](C:\Users\Administrator\AppData\Local\Temp\国同 的笔记本\pandoc/media/image3.png)

**1.3 全世界 DNS 服务器的大接力**

⭐DNS 服务器会从域名与 IP 地址的对照表中查找相应的记录，并 返回 IP 地址。
![](C:\Users\Administrator\AppData\Local\Temp\国同 的笔记本\pandoc/media/image4.png)

**1.4 委托协议栈发送消息**
⭐要先像操作系统内部的协议栈发出委托请求
⭐向操作系统内部的协议栈发出委托时，需要按照指定的顺序来调 用 Socket 库中的程序组件。

**第2章 用电信号传输 TCP/IP 数据 ——探索协议栈和网卡**
**2.1 创建套接字**
![](C:\Users\Administrator\AppData\Local\Temp\国同 的笔记本\pandoc/media/image5.png)
⭐浏览器、邮件等一般应用程序收发数据时用 **TCP**； DNS 查询等收发较短的控制数据时用 **UDP**。
⭐IP 中还包括 ICMPA 协议和 ARPB 协议。 ICMP 用于告知网络包传送过程中产生的错误以及各种控制消息，ARP 用 于根据 IP 地址查询相应的以太网 MAC 地址 C。
⭐协议栈是根据套接字中记录的控制信息来工作的。
⭐MAC 地址：符合 IEEE 规格的局域网设备都使用同一格式的地址，这种地 址被称为 MAC 地址
![](C:\Users\Administrator\AppData\Local\Temp\国同 的笔记本\pandoc/media/image6.png)

**2.2 连接服务器**
**⭐**头部用来记录和交换**控制信息**
![](C:\Users\Administrator\AppData\Local\Temp\国同 的笔记本\pandoc/media/image7.png)
⭐套接字→客户端生成头部→TCP→IP→服务器IP→服务器TCP→服务器对应套接字
**2.3 收发数据**
Write
Read
**2.4 从服务器断开并删除套接字**
⭐断开过程
（1）客户端发送 FIN
（2）服务器返回 ACK 号
（3）服务器发送 FIN
（4）客户端返回 ACK 号

![](C:\Users\Administrator\AppData\Local\Temp\国同 的笔记本\pandoc/media/image8.png)
**2.5 IP 与以太网的包收发操作**
**⭐**发送方和接收方统称为终端节点，转发设备被称为转发节点或者中间节点
![](C:\Users\Administrator\AppData\Local\Temp\国同 的笔记本\pandoc/media/image9.png)
**⭐**（1）路由器根据目标地址判断下一个路由器的位置 （2）集线器在子网中将网络包传输到下一个路由
**⭐**IP 模块负责添加如下两个头部。 （1） MAC 头部：以太网用的头部，包含 MAC 地址 （2） IP 头部：IP 用的头部，包含 IP 地址

**2.6 UDP 协议的收发操作**
**⭐**像 DNS 查询等交换控制信息的操作基本 上都可以在一个包的大小范围内解决，这种场景中就可以用 UDP 来代替 TCP。还有另一个场景会使用 UDP，就是发送音频和视频数据的时候。

**第3章 从网线到网络设备 ——探索集线器、交换机和路由器**
![](C:\Users\Administrator\AppData\Local\Temp\国同 的笔记本\pandoc/media/image10.png)
**3.1 信号在网线和集线器中传输**
**⭐**信号在网线的传输过程中， 能量会逐渐损失。网线越长，信号衰减就越严重。
**⭐**电信号的频率越高，能量的损失率越大。
**⭐**“双绞”是为了抑制噪声。
**⭐**集线器将信号发送给所有连接在它上面的线路。
**3.2 交换机的包转发操作**
**⭐**交换机根据 MAC 地址表查找 MAC 地址，然后将信号发送到相应的端口。
